import{u,r as x,i as D,s as h,h as F,A as M,y as I,j as e,C as H}from"./app-BtW_wwLH.js";import{s as O}from"./students-thunk-BphSIe_h.js";import{g as Q}from"./app-thunk-CSCZDppe.js";import{C as W,a as G}from"./CardContent-X9zzQp0v.js";import{T as N}from"./Typography-DSCsFMKV.js";import{B as A}from"./Box-Aa1GnADx.js";import{C as B}from"./CardMedia-C66nqCwj.js";import{C as U}from"./CardActions-Bk9gvuKi.js";import{T as z}from"./TextField-ugFTqZp3.js";import{F as J}from"./FormLabel-DP8-1qAP.js";import{R as K,a as c,b as d}from"./RadioGroup-Qx4-8tA0.js";import{B as j}from"./Button-CsskH969.js";import{M as P}from"./Modal-BzENkscD.js";import"./user-service-CA4WB6O0.js";import"./identifier-Bmw0gluP.js";import"./DefaultPropsProvider-CAX4ls34.js";import"./Paper-BvK90iaf.js";import"./useTheme-BVfzLAJ0.js";import"./useTheme-CgpVaOMr.js";import"./index-BJcdcpov.js";import"./ButtonBase-B6cvYeRl.js";import"./extendSxProp-DcKGbTvT.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./useSlot-CwulVA30.js";import"./resolveComponentProps-CYU_5_Ao.js";import"./useId-Oex3I69b.js";import"./utils-CnLGaUem.js";import"./react-is.production.min-DUDD-a5e.js";import"./index-BO1Eng3K.js";import"./Popover-Cuw-K5WT.js";import"./isHostComponent-DVu5iVWx.js";import"./ownerWindow-CO8Ksk3k.js";import"./debounce-Be36O1Ab.js";import"./Grow-BzJ6a_NL.js";import"./utils-WqCOSJ75.js";import"./useSlotProps-Dh5MtJkH.js";import"./useControlled-DIF0ICa5.js";import"./createSvgIcon-WbZ0ogFq.js";import"./InputBase-D54aUNiX.js";import"./isMuiElement-ByIJYNGh.js";import"./SwitchBase-BAU-dZG5.js";function Fe(){var k;u(a=>a.questionnaires);const{booklet:f}=u(a=>a.booklets),{user:r,data:b,timeLeft:g,timerActive:S}=u(a=>a.app),[L,p]=x.useState(!1),T=window.location.pathname.split("/")[3],v=D(),_=({htmlContent:a})=>e.jsx("div",{dangerouslySetInnerHTML:{__html:a}}),[q,m]=x.useState(!1),E=()=>m(!0),C=()=>m(!1),y=(a,i)=>{const s=h.getState().app.data,n=(s==null?void 0:s.answers)||[],t=n.findIndex(o=>o.questionnaire_id===a.id);let l;t!==-1?l=n.map((o,R)=>R===t?{...o,answer:i,isCorrect:a.answer_key===i}:o):l=[...n,{questionnaire_id:a.id,answer:i,isCorrect:a.answer_key===i}],v(H({...s,answers:l}))};x.useEffect(()=>{g==0&&S&&w()},[g]);function w(a){p(!0);try{h.dispatch(O({...b,user:r,date:F().format("LLLL"),als_level:f.als_level,booklet_id:T})),v(M(0)),h.dispatch(Q()),localStorage.clear(),I.visit("/student/examination"),m(!1),p(!1)}catch{m(!1),p(!1)}}return console.log("datassss",b),e.jsxs("div",{className:"flex flex-col gap-5",children:[(k=f.examinations)==null?void 0:k.map((a,i)=>e.jsxs(W,{sx:{minWidth:275},children:[e.jsx(G,{children:e.jsx(N,{variant:"body2",children:e.jsxs("div",{className:"flex gap-2 flex-col",children:[e.jsx("div",{className:"text-2xl font-black",children:a.title}),e.jsx("div",{className:"text-xl",children:a.sub_title})]})})}),a.question.map((s,n)=>{var l;let t={};return(l=r==null?void 0:r.score_sheet)!=null&&l.answers&&s.id&&(t=r.score_sheet.answers.find(o=>o.questionnaire_id===s.id)),e.jsx(A,{sx:{borderBottom:2,borderColor:"primary.main"},children:e.jsxs("div",{className:"px-3 mt-6",children:[e.jsxs("div",{className:"flex gap-3 ",children:[e.jsxs("div",{children:[s.item_number,"."]}),e.jsx("div",{className:"-mt-4",children:e.jsx(_,{htmlContent:s.question})})]}),e.jsx("div",{className:"w-full flex items-center justify-center",children:e.jsxs("div",{className:"w-1/2",children:[s.image_a&&e.jsx(B,{component:"img",height:"full",image:s.image_a,alt:"Question header image"}),s.image_header&&e.jsx(B,{component:"img",height:"full",image:s.image_header,alt:"Question header image"})]})}),e.jsx(U,{children:e.jsxs("div",{className:"flex items-start justify-start w-full px-3",children:[s.isEssay=="true"&&e.jsx(e.Fragment,{children:e.jsx(z,{onChange:o=>y(s,o.target.value),disabled:!!(t!=null&&t.answer),value:t==null?void 0:t.answer,multiline:!0,rows:3,name:"answer",type:"text",id:"outlined-basic",label:"Write Here...",variant:"outlined",className:"w-full"})}),s.isEssay!="true"&&e.jsx(J,{children:e.jsxs(K,{onChange:o=>y(s,o.target.value),row:!0,"aria-labelledby":"demo-row-radio-buttons-group-label",name:"answer_key",children:[e.jsx(c,{value:"A",control:e.jsx(d,{}),label:"A",checked:(t==null?void 0:t.answer)=="A"?!0:void 0,disabled:(t==null?void 0:t.answer)=="A"})," ",e.jsx(c,{value:"B",control:e.jsx(d,{}),label:"B",checked:(t==null?void 0:t.answer)=="B"?!0:void 0,disabled:(t==null?void 0:t.answer)=="B"}),e.jsx(c,{value:"C",control:e.jsx(d,{}),label:"C",checked:(t==null?void 0:t.answer)=="C"?!0:void 0,disabled:(t==null?void 0:t.answer)=="C"}),e.jsx(c,{value:"D",control:e.jsx(d,{}),label:"D",checked:(t==null?void 0:t.answer)=="D"?!0:void 0,disabled:(t==null?void 0:t.answer)=="D"})]})})]})})]},n)})})]},i)),!r.score_sheet&&e.jsx(j,{onClick:E,variant:"contained",children:"SUBMIT ANSWER"}),e.jsx(P,{open:q,onClose:C,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(A,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",p:4},children:[e.jsx(N,{id:"modal-modal-description",children:"Are you sure you want to submit your answer?"}),e.jsxs("div",{className:"w-full flex gap-3 mt-12",children:[e.jsx(j,{onClick:C,variant:"outlined",className:"w-full",color:"error",children:"Cancel"}),e.jsx(j,{disabled:L,onClick:w,variant:"contained",className:"w-full",color:"primary",children:"Submit"})]})]})})]})}export{Fe as default};
